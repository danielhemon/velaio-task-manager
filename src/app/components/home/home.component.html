<div class="container">
  <h1 class="title">VELAIO TASK MANAGER</h1>

  <div class="add-section">
    <button class="add-task-btn" (click)="toggleForm()">
      ADD TASK &nbsp;<i class="fa-solid fa-plus"></i>
    </button>
    <div class="add-form-section" *ngIf="showAddForm">
      <form [formGroup]="taskForm" (ngSubmit)="onSubmit()">
        <div>
          <label class="form-lbl" for="title">Title</label>
          <input
            class="form-inpt"
            id="title"
            formControlName="title"
            type="text"
          />
          <div *ngIf="getCtrl('title').touched && getCtrl('title').invalid">
            <small *ngIf="getCtrl('title').errors?.['required']"
              >Title is required.</small
            >
            <small *ngIf="getCtrl('title').errors?.['maxlength']"
              >The title cannot exceed 100 characters.</small
            >
          </div>
        </div>

        <div>
          <label class="form-lbl" for="description">Description</label>
          <textarea
            class="form-inpt"
            id="description"
            formControlName="description"
          ></textarea>
          <div
            *ngIf="
              getCtrl('description').touched && getCtrl('description').invalid
            "
          >
            <small *ngIf="getCtrl('description').errors?.['required']"
              >Description is required.</small
            >
            <small *ngIf="getCtrl('description').errors?.['maxlength']"
              >The description cannot exceed 500 characters.</small
            >
          </div>
        </div>

        <div>
          <label class="form-lbl" for="assignedTo">Assigned to</label>
          <input
            class="form-inpt"
            id="assignedTo"
            formControlName="assignedTo"
            type="text"
          />
          <div
            *ngIf="
              getCtrl('assignedTo').touched && getCtrl('assignedTo').invalid
            "
          >
            <small *ngIf="getCtrl('assignedTo').errors?.['required']"
              >The "Assigned to" field is required.</small
            >
            <small *ngIf="getCtrl('assignedTo').errors?.['maxlength']"
              >The "Assigned To" field cannot exceed 100 characters.</small
            >
          </div>
        </div>

        <button
          type="button"
          class="submit-btn"
          [disabled]="taskForm.invalid"
          (click)="onSubmit()"
        >
          Add
        </button>
      </form>
    </div>
  </div>

  <div class="task-board">
    <div class="task-column todo">
      <h3 class="colum-title">
        <i class="fa-solid fa-clock"></i> &nbsp; To do
      </h3>
      <div *ngFor="let task of tasksTodo" class="task-card">
        <h4 class="task-title">{{ task.title }}</h4>
        <p>{{ task.description }}</p>
        <p><strong>Assigned to:</strong> {{ task.assignee }}</p>
        <div class="actions">
          <button
            class="action-btn"
            (click)="updateTaskStatus(task, 'in-progress')"
          >
            Move to In Progress &nbsp;<i
              class="fa-solid fa-hourglass-start"
            ></i>
          </button>
          <button class="action-btn" (click)="deleteTask(task)">
            Delete &nbsp;<i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="task-column inprog">
      <h3 class="colum-title">
        <i class="fa-solid fa-hourglass-start"></i> &nbsp; In Progress
      </h3>
      <div *ngFor="let task of tasksInProgress" class="task-card">
        <h4 class="task-title">{{ task.title }}</h4>
        <p>{{ task.description }}</p>
        <p><strong>Assigned to:</strong> {{ task.assignee }}</p>
        <div class="actions">
          <button class="action-btn" (click)="updateTaskStatus(task, 'done')">
            Move to Done &nbsp;
            <i class="fa-regular fa-square-check"></i>
          </button>
          <button class="action-btn" (click)="deleteTask(task)">
            Delete &nbsp;<i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    </div>

    <div class="task-column done">
      <h3 class="colum-title">
        <i class="fa-regular fa-square-check"></i> &nbsp; Done
      </h3>
      <div *ngFor="let task of tasksDone" class="task-card">
        <h4 class="task-title">{{ task.title }}</h4>
        <p>{{ task.description }}</p>
        <p><strong>Assigned to:</strong> {{ task.assignee }}</p>
        <div class="actions">
          <button
            class="action-btn"
            class="action-btn"
            (click)="updateTaskStatus(task, 'todo')"
          >
            Move to To Do &nbsp;<i class="fa-solid fa-clock"></i>
          </button>
          <button class="action-btn" (click)="deleteTask(task)">
            Delete &nbsp;<i class="fa-solid fa-trash"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
